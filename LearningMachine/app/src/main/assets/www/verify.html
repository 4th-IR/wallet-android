<html>
	<head>
		<script src="./verifier.js"></script>
	</head>

	<body>
    <script>
			function loadJSON(url, callback) {
				var xobj = new XMLHttpRequest();
				xobj.overrideMimeType("text/plain");
				xobj.open('GET', url, true);
				xobj.onreadystatechange = function () {
				      if (xobj.readyState == 4 && (xobj.status == "200" || xobj.status == "0")) {
						  callback(xobj.responseText);
				      }
				};
				xobj.send(null);
			}

			function statusCallback(arg1) {
				Android.notifyStatusChanged(JSON.stringify(arg1))
			}

			loadJSON("./certificate.json", async function(certificateContentsString) {
                var certificate = new Verifier.Certificate(certificateContentsString)
                Android.notifyChainType(certificate.chain.code, certificate.chain.name)
                var verificationSteps = certificate.verificationSteps
                Android.notifyVerificationSteps(JSON.stringify(verificationSteps))
                var lastStep = await certificate.verify(statusCallback)
                Android.notifyLastStep(JSON.stringify(lastStep))
            });
		</script>
    </body>
</html>